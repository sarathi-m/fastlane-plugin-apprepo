machine:
  ruby:
    version: 2.2.5

dependencies:
  pre:
    - gem install bundler
    - gem install fastlane
    - bundle update

  override:
    - bundle install: # note ':' here
        timeout: 180 # fail if command has no output for 3 minutes

test:
  override:
    - nslookup repo.teacloud.net
    - fastlane add_plugin apprepo
    - fastlane apprepo run
    - fastlane apprepo download_manifest
    - fastlane apprepo submit
    - COVERALLS_REPO_TOKEN=5NIxBldNBfJzPgvlQnVojxNNW0197fUUf RAILS_ENV=test bundle exec rspec
    - curl -X POST --data-urlencode 'payload={"text":"CirleCI Integration Completed."}' https://hooks.slack.com/services/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

  post:
    - curl -sSL https://download.sourceclear.com/ci.sh | sh
    - curl -X POST -H "Content-type: application/json" --data '{"text":"Hello, World A!"}' https://hooks.slack.com/services/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

## Custom notifications
# notify:
#  - curl -X POST -H 'Content-type: application/json' --data '{"text":"Hello, World B!"}' https://hooks.slack.com/services/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
#  webhooks:
#   - url: https://hooks.slack.com/services/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?payload={"text":"Hello, World!"}
#   - curl -X POST -H 'Content-type: application/json' --data '{"text":"Hello, World C!"}' https://hooks.slack.com/services/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
